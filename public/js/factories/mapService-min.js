(function(){var e;e=angular.module("peer2package"),e.service("mapService",["$rootScope","$geolocation","socket","$interval","userService",function(e,o,t,n,a){var r,i,u;return r=a.currentUser(),e.mapOff=function(e){return n.cancel(e)},e.loading=!0,u=null,i=null,e.$on("$viewContentLoaded",function(){var a;return o.getCurrentPosition({timeout:6e4}).then(function(a){var c,l,s;if(u=a.coords.longitude,i=a.coords.latitude,e.myPosition=a,e.myInterval=n(function(){o.getCurrentPosition({timeout:6e4}).then(function(o){var n,a;e.myPosition=o,u=o.coords.longitude,i=o.coords.latitude,n="http://localhost:8000/user_location",a=r.email+", "+u+", "+i,t.emit("LngLat",a),l.setData(n)})},1e3),mapboxgl.accessToken="pk.eyJ1IjoiamFtZXNhZGlja2Vyc29uIiwiYSI6ImNpbmNidGJqMzBwYzZ2OGtxbXljY3FrNGwifQ.5pIvQjtuO31x4OZm84xycw",document.getElementById("map")&&(c=new mapboxgl.Map({container:"map",style:"mapbox://styles/jamesadickerson/ciq1h3u9r0009b1lx99e6eujf",zoom:19})),s="http://localhost:8000/user_location",l=new mapboxgl.GeoJSONSource({data:s}),document.getElementById("map"))return c.on("load",function(){return e.loading=!1,c.addSource("You",l),c.addLayer({id:"You",type:"symbol",source:"You",layout:{"icon-image":"car"},paint:{}}),c.setCenter([u,i]),console.log(u+","+i),c.on("click",function(e){var o,t,n;if(t=c.queryRenderedFeatures(e.point,{layers:["You"]}),t.length)return o=t[0],n=new mapboxgl.Popup({closeButton:!1}).setLngLat([u,i]).setHTML(o.properties.description).addTo(c)})})}),a=function(){return map.flyTo({center:[u,i]})}})}])}).call(this);