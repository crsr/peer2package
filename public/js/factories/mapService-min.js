(function(){var t;t=angular.module("peer2package"),t.service("mapService",["$rootScope","$geolocation","socket","$interval","userService","$http",function(t,e,o,n,a,i){var r,c;return t.mapOff=function(t){return n.cancel(t)},t.loading=!0,c=null,r=null,t.$on("$viewContentLoaded",function(){var u;return e.getCurrentPosition({timeout:6e4}).then(function(u){var l,s,d;if(c=u.coords.longitude,r=u.coords.latitude,t.myPosition=u,t.myInterval=n(function(){e.getCurrentPosition({timeout:6e4}).then(function(e){var n,i,u;t.myPosition=e,n=a.currentUser(),c=e.coords.longitude,r=e.coords.latitude,i="http://localhost:8000/locations",u=n.email+", "+c+", "+r,o.emit("LngLat",u)})},1e3),mapboxgl.accessToken="pk.eyJ1IjoiamFtZXNhZGlja2Vyc29uIiwiYSI6ImNpbmNidGJqMzBwYzZ2OGtxbXljY3FrNGwifQ.5pIvQjtuO31x4OZm84xycw",document.getElementById("map")&&(s=new mapboxgl.Map({container:"map",style:"mapbox://styles/jamesadickerson/ciq1h3u9r0009b1lx99e6eujf",zoom:19})),d="http://localhost:8000/locations",l=null,i.get(d).then(function(t){return l=t.data}),document.getElementById("map"))return s.on("load",function(){return t.loading=!1,s.addSource("Locations",{type:"geojson",data:l}),s.addLayer({id:"Locations",type:"symbol",source:"Locations",layout:{"icon-image":"{icon}"},paint:{}}),s.setCenter([c,r]),s.on("click",function(t){var e,o,n;if(o=s.queryRenderedFeatures(t.point,{layers:["Locations"]}),o.length)return e=o[0],n=new mapboxgl.Popup({closeButton:!1}).setLngLat([c,r]).setHTML(e.properties.description).addTo(s)})})}),u=function(){return map.flyTo({center:[c,r]})}})}])}).call(this);