(function(){var t;t=angular.module("peer2package"),t.service("mapService",["$rootScope","$geolocation","socket","$interval","userService","$http",function(t,e,o,n,a,i){var r,c;return t.mapOff=function(t){return n.cancel(t)},t.loading=!0,c=null,r=null,t.$on("$viewContentLoaded",function(){var l;return e.getCurrentPosition({timeout:6e4}).then(function(l){var u,s,d;if(c=l.coords.longitude,r=l.coords.latitude,t.myPosition=l,t.myInterval=n(function(){e.getCurrentPosition({timeout:6e4}).then(function(e){var n,i,l;t.myPosition=e,n=a.currentUser(),c=e.coords.longitude,r=e.coords.latitude,i="http://localhost:8000/locations",l=n.email+", "+c+", "+r,o.emit("LngLat",l)})},1e3),mapboxgl.accessToken="pk.eyJ1IjoiamFtZXNhZGlja2Vyc29uIiwiYSI6ImNpbmNidGJqMzBwYzZ2OGtxbXljY3FrNGwifQ.5pIvQjtuO31x4OZm84xycw",document.getElementById("map")&&(s=new mapboxgl.Map({container:"map",style:"mapbox://styles/jamesadickerson/ciq1h3u9r0009b1lx99e6eujf",zoom:19})),d="http://localhost:8000/locations",u=null,i.get(d).then(function(t){return u=t.data,console.log(u)}),document.getElementById("map"))return s.on("load",function(){return t.loading=!1,s.addSource("Locations",{type:"geojson",data:u}),s.addLayer({id:"Locations",type:"symbol",source:"Locations",layout:{"icon-image":"{icon}"},paint:{}}),s.setCenter([c,r]),s.on("click",function(t){var e,o,n;if(o=s.queryRenderedFeatures(t.point,{layers:["Locations"]}),o.length)return e=o[0],n=new mapboxgl.Popup({closeButton:!1}).setLngLat([c,r]).setHTML(e.properties.description).addTo(s)})})}),l=function(){return map.flyTo({center:[c,r]})}})}])}).call(this);