(function(){var e;e=angular.module("peer2package"),e.service("mapService",["$rootScope","$geolocation","socket","$interval",function(e,o,t,n){var a,r;return e.mapOff=function(e){return n.cancel(e)},e.loading=!0,r=null,a=null,e.$on("$viewContentLoaded",function(){var i;return o.getCurrentPosition({timeout:6e4}).then(function(i){var u,c,l;if(r=i.coords.longitude,a=i.coords.latitude,e.myPosition=i,e.myInterval=n(function(){o.getCurrentPosition({timeout:6e4}).then(function(o){var n,i;e.myPosition=o,r=o.coords.longitude,a=o.coords.latitude,n="http://localhost:8000/user_location",i=r+", "+a,c.setData(n),t.emit("LngLat",i)})},1e3),mapboxgl.accessToken="pk.eyJ1IjoiamFtZXNhZGlja2Vyc29uIiwiYSI6ImNpbmNidGJqMzBwYzZ2OGtxbXljY3FrNGwifQ.5pIvQjtuO31x4OZm84xycw",document.getElementById("map")&&(u=new mapboxgl.Map({container:"map",style:"mapbox://styles/jamesadickerson/ciq1h3u9r0009b1lx99e6eujf",zoom:19})),l="http://localhost:8000/user_location",c=new mapboxgl.GeoJSONSource({data:l}),document.getElementById("map"))return u.on("load",function(){return e.loading=!1,u.addSource("You",c),u.addLayer({id:"You",type:"symbol",source:"You",layout:{"icon-image":"car"},paint:{}}),u.setCenter([r,a]),console.log(r+","+a),u.on("click",function(e){var o,t,n;if(t=u.queryRenderedFeatures(e.point,{layers:["You"]}),t.length)return o=t[0],n=new mapboxgl.Popup({closeButton:!1}).setLngLat([r,a]).setHTML(o.properties.description).addTo(u)})})}),i=function(){return map.flyTo({center:[r,a]})}})}])}).call(this);